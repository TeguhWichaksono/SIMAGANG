<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SI MAGANG</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />
    <link rel="stylesheet" href="styles.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="logo">
        <svg width="100" height="40" viewBox="0 0 100 40">
          <path d="M12,15 L30,15 L24,27 L12,27 Z" fill="#4270F4" />
          <text x="38" y="27" fill="#262A39" font-size="20" font-weight="bold">
            SMG
          </text>
        </svg>
      </div>

      <div class="nav-menu">
        <a href="#" class="nav-item active">
          <i class="fas fa-home"></i>
          <span>Dashboard</span>
        </a>
        <a href="profile.html" class="nav-item">
          <i class="fas fa-user-circle"></i>
          <span>Akun</span>
        </a>
        <a href="#" class="nav-item">
          <i class="fas fa-users-gear"></i>
          <span>Manajemen User</span>
        </a>
        <a href="#" class="nav-item">
          <i class="fas fa-building"></i>
          <span>Manajemen Mitra</span>
        </a>
        <a href="#" class="nav-item">
          <i class="fas fa-chart-line"></i>
          <span>Laporan Sistem</span>
        </a>
        <a href="#" class="nav-item">
          <i class="fas fa-bell"></i>
          <span>Notifikasi</span>
        </a>
        <a href="#" class="nav-item">
          <i class="fas fa-life-ring"></i>
          <span>Help Center</span>
        </a>
      </div>

      <div class="premium-box">
        <h3>Upgrade to Elite Plan</h3>
        <button class="premium-btn">Try Free</button>
      </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <!-- Header -->
      <div class="header">
        <div class="welcome-section">
          <p class="greeting">Selamat Datang , E31241242 Septiya Qorrata Ayun </p>
          <h1 class="welcome-title">Dashboard </h1>
        </div>

        <div class="header-right">
          <div class="notification-bell">
            <i class="fas fa-bell"></i>
            <div class="notification-indicator"></div>
          </div>

          <div class="user-profile">
            <img
              src="images/tyaa.jpg"
              alt="Alex Morgan"
              class="profile-pic"
            />
          </div>

          <div class="search-bar">
            <i class="fas fa-search"></i>
            <input type="text" placeholder="Mencari" />
          </div>
        </div>
      </div>

      <!-- Dashboard Container -->
      <div class="dashboard-container">
        <!-- Main Dashboard Content -->
        <div class="dashboard-main">
          <!-- Transfer Cards -->
          <div class="transfer-cards">
            <div class="transfer-card">
              <div class="card-icon">
                <i class="fas fa-users"></i>
              </div>
              <p class="card-title">Jumlah Mahasiswa Magang</p>
              <h2 class="card-amount">94 Mahasiswa</h2>
            </div>

            <div class="transfer-card">
              <div class="card-icon">
                <i class="fas fa-chalkboard-teacher"></i>
              </div>
              <p class="card-title">Jumlah Dosen Pembimbing</p>
              <h2 class="card-amount">45 Dosen</h2>
            </div>

            <div class="transfer-card">
              <div class="card-icon">
                <i class="fas fa-building"></i>
              </div>
              <p class="card-title">Jumlah Instansi/perusahaan Mitra</p>
              <h2 class="card-amount">165 Mitra</h2>
            </div>
          </div>

          <!-- Pemetaan Mitra + Diagram Donat -->
          <div class="transaction-section" style="display:flex; gap:20px; flex-wrap:wrap;">
            <!-- Peta -->
            <div class="transaction-card" style="flex:1; min-width:300px; height:300px;">
              <h3 class="section-title">Pemetaan Mitra</h3>
              <div id="map" style="width:100%; height:100%; border-radius:10px;"></div>
            </div>

            <!-- Diagram Donat -->
            <div class="transaction-card" style="flex:1; min-width:300px; height:300px;">
              <h3 class="section-title">Klasifikasi Mitra Berdasarkan Industri</h3>
              <canvas id="mitraDoughnutChart" width="300" height="300"></canvas>
            </div>
          </div>

          <!-- Aktivitas Terbaru -->
          <div class="transaction-section">
            <div class="transaction-card">
              <h3 class="section-title">Aktivitas Terbaru </h3>

              <div class="transaction-item">
                <div class="transaction-icon">
                  <img
                    src="https://i.pravatar.cc/100?img=12"
                    alt="Lisa Johnson"
                  />
                </div>
                <div class="transaction-content">
                  <div class="transaction-title">Divaa cantik</div>
                  <div class="transaction-time">
                    <i class="far fa-clock"></i> Today, 09:35
                  </div>
                </div>
                <div class="transaction-amount positive">Selesai</div>
              </div>

              <div class="transaction-item">
                <div class="transaction-icon">
                  <img
                    src="https://i.pravatar.cc/100?img=11"
                    alt="Michael Torres"
                  />
                </div>
                <div class="transaction-content">
                  <div class="transaction-title">Tyaa Cantik</div>
                  <div class="transaction-time">
                    <i class="far fa-clock"></i> Monday, 17:45
                  </div>
                </div>
                <div class="transaction-amount negative">-Belum</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Dashboard Sidebar -->
        <div class="dashboard-sidebar">
          <!-- Diagram Garis Lama -->
          <div class="savings-card">
            <h3 class="savings-title">Jumlah Mahasiswa Aktif</h3>
            <div class="savings-amount">65 Mahasiswa</div>

            <div class="time-filter">
              <button class="time-option">Harian</button>
              <button class="time-option">Mingguan</button>
              <button class="time-option active">Bulanan</button>
              <button class="time-option">Lainnya</button>
            </div>

            <div class="chart-container">
              <svg
                class="chart"
                viewBox="0 0 300 100"
                preserveAspectRatio="none"
              >
                <defs>
                  <linearGradient
                    id="gradientFill"
                    x1="0%"
                    y1="0%"
                    x2="0%"
                    y2="100%"
                  >
                    <stop offset="0%" stop-color="#4270F4" stop-opacity="0.7" />
                    <stop
                      offset="100%"
                      stop-color="#4270F4"
                      stop-opacity="0.1"
                    />
                  </linearGradient>
                </defs>
                <path
                  class="chart-line-path"
                  d="M0,80 C20,70 40,30 60,60 C80,90 100,40 120,30 C140,20 160,50 180,20 C200,30 220,60 240,80 C260,60 280,40 300,60"
                ></path>
                <path
                  class="chart-area"
                  d="M0,80 C20,70 40,30 60,60 C80,90 100,40 120,30 C140,20 160,50 180,20 C200,30 220,60 240,80 C260,60 280,40 300,60 L300,100 L0,100 Z"
                ></path>
                <circle
                  cx="180"
                  cy="20"
                  r="6"
                  fill="#4270F4"
                  stroke="#ffffff"
                  stroke-width="3"
                />
              </svg>
            </div>

            <div class="timeline">
              <div class="month">Okt</div>
              <div class="month">Nov</div>
              <div class="month active">Des</div>
              <div class="month">Jan</div>
              <div class="month">Feb</div>
              <div class="month">Mar</div>
            </div>
          </div>

          <div class="plan-card">
            <div class="plan-info">
              <div class="plan-title">Mahasiswa Sudah Ditempatkan</div>
              <div class="plan-status">Proses</div>
            </div>

            <div class="plan-progress">
              <div class="plan-percentage">68%</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>

    <script>
      // Peta Jember
      var map = L.map('map').setView([-8.1731, 113.7035], 12);

      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
      }).addTo(map);

      var markersGroup = L.markerClusterGroup();

      var mitra = [
        { name: "PT Jember Abadi", coords: [-8.1681, 113.7040], address: "Jl. Letjen Panjaitan No.1" },
        { name: "CV Jember Maju", coords: [-8.1800, 113.6950], address: "Jl. Gajah Mada No.12" },
        { name: "Koperasi Sejahtera", coords: [-8.1750, 113.7100], address: "Jl. Sudirman No.5" },
        { name: "PT Nusantara Jember", coords: [-8.1700, 113.7200], address: "Jl. Ahmad Yani No.25" },
        { name: "CV Sentosa", coords: [-8.1650, 113.6900], address: "Jl. Raya Jember No.8" }
      ];

      mitra.forEach(m => {
        var marker = L.marker(m.coords).bindPopup(`<b>${m.name}</b><br>${m.address}`);
        markersGroup.addLayer(marker);
      });

      map.addLayer(markersGroup);
      if (markersGroup.getLayers().length > 0) {
        map.fitBounds(markersGroup.getBounds(), { padding:[40,40] });
      }

      // Pastikan peta menyesuaikan size
      setTimeout(() => { map.invalidateSize(); }, 100);

      // Diagram Donat Klasifikasi Mitra
      const ctxDoughnut = document.getElementById('mitraDoughnutChart').getContext('2d');
      const mitraDoughnutChart = new Chart(ctxDoughnut, {
        type: 'doughnut',
        data: {
          labels: ['Teknologi', 'Pendidikan', 'Kesehatan', 'Manufaktur', 'Retail'],
          datasets: [{
            data: [40, 25, 20, 50, 30],
            backgroundColor: ['#4270F4','#42F4C4','#F4B142','#F44174','#7D42F4'],
            borderColor: '#fff',
            borderWidth: 2
          }]
        },
        options: { responsive:true, cutout:'50%', plugins:{ legend:{ position:'bottom' } } }
      });
    </script>
  </body>
</html>
